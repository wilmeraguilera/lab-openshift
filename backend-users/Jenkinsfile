//Variables del proceso
def tagImage
def artifactName
def artifactVersion
def nameJar
def isRelease
def var_context_dir


def namespace_dev ="dev-admin-users"
def namespace_qa = "qa-admin-users"
def appName = "api-users"
def context_dir ="backend-users"




//Constantes
def CONFIG_FILE_NAME="application.properties"


pipeline {

  //agent any

  agent {
      label "maven"
  }
/*
  tools {
    maven 'M2-3.6.3'
    jdk 'JDK18'
  }
*/

  stages {



    stage("Config Dev Environment") {
        		steps {
        		    dir(var_context_dir) {
                        script {
                            openshift.withCluster() {
                                   openshift.withProject("${namespace_dev}") {

                                        echo "ConfigFile Name ${config_file_name}"



                                   }
                            }
                        }
                        sh """
                            oc project ${namespace_dev}
                            oc process -f configuration/openshift/template-java-app.yml -p APPLICATION_NAME=${appName}  -p JAVA_VERSION=${jdkVersionImage} -p CONFIG_FILE_NAME=${config_file_name} | oc apply -f-
                         """
        		    }
            	}
        }



  }
}